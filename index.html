<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‚</title>
    
    <!-- ç½‘ç«™ç¼©ç•¥å›¾/é¢„è§ˆå›¾è®¾ç½® -->
    <meta property="og:title" content="ğŸ‚ ç”Ÿæ—¥å¿«ä¹">
    <meta property="og:description" content="ç”Ÿæ—¥ç¥ç¦ç½‘ç«™">
    <meta property="og:image" content="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='50' font-size='50' text-anchor='middle' x='50'%3eğŸ‚%3c/text%3e%3c/svg%3e">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="ğŸ‚ ç”Ÿæ—¥å¿«ä¹">
    <meta name="twitter:description" content="ç”Ÿæ—¥ç¥ç¦ç½‘ç«™">
    <meta name="twitter:image" content="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='50' font-size='50' text-anchor='middle' x='50'%3eğŸ‚%3c/text%3e%3c/svg%3e">
    
    <!-- Faviconè®¾ç½® -->
    <link rel="icon" href="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='50' font-size='50' text-anchor='middle' x='50'%3eğŸ‚%3c/text%3e%3c/svg%3e">
    
    <link href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/TakWolf/fusion-pixel-font@main/dist/fusion-pixel-8px-monospaced-zh_hans.css" rel="stylesheet">
    <style>
        * {
            font-family: 'Press Start 2P', 'Courier New', 'Monaco', 'Menlo', 'Consolas', monospace;
        }
        
        /* åƒç´ é£æ ¼å­—ä½“ */
        .pixel-font {
            font-family: 'Press Start 2P', 'Courier New', monospace;
            image-rendering: pixelated;
            -webkit-font-smoothing: none;
            font-smoothing: none;
            letter-spacing: 1px;
        }
        
        /* åƒç´ é£æ ¼æŒ‰é’®åŸºç¡€æ ·å¼ */
        .pixel-btn {
            border: 3px solid #8b5a8c;
            box-shadow: 3px 3px 0px #d4a5d6;
            transition: all 0.1s ease;
            image-rendering: pixelated;
            position: relative;
        }
        
        /* åƒç´ é£æ ¼çº¹ç†è¦†ç›–å±‚ */
        .pixel-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%), 
                        linear-gradient(-45deg, rgba(255,255,255,0.15) 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.15) 75%), 
                        linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.15) 75%);
            background-size: 4px 4px;
            background-position: 0 0, 0 2px, 2px -2px, -2px 0px;
            pointer-events: none;
        }
        
        .pixel-btn:hover {
            transform: translate(1px, 1px);
            box-shadow: 2px 2px 0px #d4a5d6;
        }
        
        .pixel-btn:active {
            transform: translate(3px, 3px);
            box-shadow: 0px 0px 0px #d4a5d6;
        }
        
        /* ç²¾è‡´å¥³ç¥é…è‰²æŒ‰é’®æ ·å¼ */
        .pixel-btn-pink {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            color: #8b5a8c;
            font-weight: bold;
        }
        
        .pixel-btn-pink:hover {
            background: linear-gradient(135deg, #ff8a95 0%, #fdbde8 50%, #fdbde8 100%);
        }
        
        .pixel-btn-lavender {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 50%, #d299c2 100%);
            color: #6b4c93;
            font-weight: bold;
        }
        
        .pixel-btn-lavender:hover {
            background: linear-gradient(135deg, #96e6e2 0%, #fcc5d8 50%, #c788b3 100%);
        }
        
        .pixel-btn-rose {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 50%, #ff8a80 100%);
            color: #8b4513;
            font-weight: bold;
        }
        
        .pixel-btn-rose:hover {
            background: linear-gradient(135deg, #ffe0c4 0%, #faa690 50%, #ff7a70 100%);
        }
        
        .pixel-btn-purple {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: white;
            font-weight: bold;
        }
        
        .pixel-btn-purple:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 50%, #e083eb 100%);
        }
        
        .pixel-btn-peach {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 50%, #fd79a8 100%);
            color: #8b4513;
            font-weight: bold;
        }
        
        .pixel-btn-peach:hover {
            background: linear-gradient(135deg, #fde498 0%, #f9a190 50%, #fc6998 100%);
        }
        
        /* åƒç´ é£æ ¼å›¾ç‰‡ */
        .pixel-img {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        /* ç²¾è‡´å¥³ç¥é£æ ¼å€’è®¡æ—¶æ˜¾ç¤º */
        .timer-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: 4px solid #8b5a8c;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            box-shadow: 
                inset 0 0 20px rgba(255, 255, 255, 0.3),
                0 0 20px rgba(139, 90, 140, 0.4);
            border-radius: 15px;
        }
        
        /* ç”Ÿæ—¥è›‹ç³•emojiåŠ¨æ•ˆ */
        .cake-emoji {
            position: fixed;
            font-size: 24px;
            pointer-events: none;
            z-index: 1000;
            animation: float 2s ease-out forwards;
        }
        
        @keyframes float {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) rotate(360deg);
            }
        }
        
        /* è„‰å†²åŠ¨ç”» */
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 10px rgba(255, 154, 158, 0.6));
            }
            50% {
                transform: scale(1.05);
                filter: drop-shadow(0 0 20px rgba(255, 154, 158, 0.8));
            }
        }
        
        /* é¡µé¢èƒŒæ™¯æ¸å˜ */
        body {
            background: linear-gradient(135deg, #ffeef8 0%, #f8f4ff 50%, #fff0f5 100%);
            min-height: 100vh;
        }
        
        /* çŠ¶æ€æ–‡å­—æ ·å¼ */
 zd        .status-text {
            color: #2d1b69;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }
        background: linear-gradient(135deg, #ff9a9e, #fecfef, #a8edea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .pixel-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .timer-display {
                font-size: 20px;
                padding: 12px;
            }
            
            /* ç§»åŠ¨ç«¯å›¾ç‰‡ä¼˜åŒ– */
            .pixel-img {
                max-height: 280px;
                width: auto;
                object-fit: contain;
            }
            
            /* è°ƒæ•´å®¹å™¨é—´è· */
            .container {
                padding: 12px;
                max-width: 100%;
            }
            
            .mb-8 {
                margin-bottom: 1rem;
            }
            
            .mb-6 {
                margin-bottom: 0.75rem;
            }
            
            .status-text {
                font-size: 16px;
                line-height: 1.4;
            }
        }
        
        @media (max-width: 480px) {
            .pixel-btn {
                padding: 8px 16px;
                font-size: 12px;
                min-height: 44px; /* ç¡®ä¿è§¦æ‘¸å‹å¥½ */
            }
            
            .timer-display {
                font-size: 18px;
                padding: 10px;
            }
            
            /* å°å±å¹•å›¾ç‰‡ä¼˜åŒ– */
            .pixel-img {
                max-height: 240px;
                width: auto;
            }
            
            .status-text {
                font-size: 14px;
                line-height: 1.3;
            }
            
            /* ç¡®ä¿é¡µé¢å†…å®¹åœ¨è§†çª—å†… */
            body {
                padding: 8px;
            }
            
            .container {
                padding: 8px;
                max-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            
            .mb-8 {
                margin-bottom: 0.75rem;
            }
            
            .mb-6 {
                margin-bottom: 0.5rem;
            }
            
            /* æŒ‰é’®åŒºåŸŸä¼˜åŒ– */
            #buttonArea {
                gap: 8px;
            }
        }
        
        /* iPhone SE ç­‰å°å±è®¾å¤‡ç‰¹æ®Šé€‚é… */
        @media (max-width: 375px) and (max-height: 667px) {
            .pixel-img {
                max-height: 200px;
            }
            
            .timer-display {
                font-size: 16px;
                padding: 8px;
            }
            
            .status-text {
                font-size: 12px;
            }
            
            .container {
                padding: 6px;
            }
            
            .mb-8 {
                margin-bottom: 0.5rem;
            }
            
            .mb-6 {
                margin-bottom: 0.25rem;
            }
        }
        
        /* iPhone Pro Max ç­‰å¤§å±é€‚é… */
        @media (max-width: 428px) and (min-height: 900px) {
            .pixel-img {
                max-height: 320px;
            }
            
            .timer-display {
                font-size: 22px;
                padding: 14px;
            }
            
            .status-text {
                font-size: 18px;
            }
        }
        
        /* æ¨ªå±é€‚é… */
        @media (max-height: 500px) and (orientation: landscape) {
            .pixel-img {
                max-height: 150px;
            }
            
            .container {
                padding: 4px;
            }
            
            .mb-8 {
                margin-bottom: 0.25rem;
            }
            
            .mb-6 {
                margin-bottom: 0.25rem;
            }
            
            .timer-display {
                font-size: 16px;
                padding: 6px;
            }
            
            .status-text {
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .pixel-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .timer-display {
                font-size: 20px;
                padding: 12px;
            }
            
            /* iPhone Pro ä¼˜åŒ– - æ˜¾è‘—å¢å¤§ */
            .pixel-img {
                max-height: 380px;
                width: auto;
            }
            
            .status-text {
                font-size: 18px;
                line-height: 1.3;
            }
            
            /* ç¡®ä¿é¡µé¢å†…å®¹åœ¨è§†çª—å†… */
            body {
                padding: 6px;
            }
            
            .container {
                max-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
            
            .mb-8 {
                margin-bottom: 0.75rem;
            }
            
            .mb-6 {
                margin-bottom: 0.5rem;
            }
        }
        
        /* iPhone Pro Max ç‰¹æ®Šé€‚é… */
        @media (max-width: 428px) and (max-height: 926px) {
            .pixel-img {
                max-height: 400px;
            }
            
            .timer-display {
                font-size: 18px;
                padding: 10px;
            }
            
            .status-text {
                font-size: 16px;
            }
        }
        
        /* iPhone Pro æ ‡å‡†ç‰ˆé€‚é… */
        @media (max-width: 390px) and (max-height: 844px) {
            .pixel-img {
                max-height: 360px;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="container max-w-md mx-auto text-center">
        <!-- ä¸»å›¾ç‰‡ -->
        <div class="mb-8">
            <img src="birthday.png" alt="Birthday" class="pixel-img mx-auto max-w-full h-auto rounded-lg pulse-animation" id="mainImage">
        </div>
        
        <!-- çŠ¶æ€æ–‡å­— -->
        <div class="mb-6">
            <p class="pixel-font status-text text-xl md:text-2xl leading-relaxed" id="statusText">
                å¼€å§‹ä»Šå¤©çš„ä¸“æ³¨å§
            </p>
        </div>
        
        <!-- å€’è®¡æ—¶æ˜¾ç¤º -->
        <div class="mb-8">
            <div class="timer-display inline-block px-6 py-4 text-2xl md:text-3xl" id="timerDisplay">
                25:00
            </div>
        </div>
        
        <!-- æŒ‰é’®åŒºåŸŸ -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center" id="buttonArea">
            <button class="pixel-btn pixel-btn-pink pixel-font px-6 py-3 rounded-lg text-lg font-bold" id="primaryBtn">
                å¼€å§‹ä¸“æ³¨
            </button>
        </div>
    </div>
    
    <script>
        class PomodoroTimer {
            constructor() {
                this.state = 'before'; // before, working, after, resting
                this.timeLeft = 25 * 60; // 25åˆ†é’Ÿ
                this.restTime = 5 * 60; // 5åˆ†é’Ÿ
                this.timer = null;
                this.hasNotificationPermission = false;
                this.startTime = null; // æ·»åŠ å¼€å§‹æ—¶é—´æˆ³
                this.totalDuration = 0; // æ·»åŠ æ€»æ—¶é•¿
                
                this.statusText = document.getElementById('statusText');
                this.timerDisplay = document.getElementById('timerDisplay');
                this.buttonArea = document.getElementById('buttonArea');
                this.primaryBtn = document.getElementById('primaryBtn');
                this.mainImage = document.getElementById('mainImage');
                
                this.init();
            }
            
            init() {
                this.updateDisplay();
                this.setupEventListeners();
                this.setupMouseEffect();
            }
            
            setupEventListeners() {
                this.primaryBtn.addEventListener('click', () => this.handlePrimaryAction());
            }
            
            setupMouseEffect() {
                // é¼ æ ‡ç§»åŠ¨ç‰¹æ•ˆ
                document.addEventListener('mousemove', (e) => {
                    if (Math.random() < 0.1) { // 10%æ¦‚ç‡ç”Ÿæˆè›‹ç³•
                        this.createCakeEmoji(e.clientX, e.clientY);
                    }
                });
                
                // è§¦å±ç‚¹å‡»ç‰¹æ•ˆ
                document.addEventListener('touchstart', (e) => {
                    // åªåœ¨éæŒ‰é’®å…ƒç´ ä¸Šé˜»æ­¢é»˜è®¤è¡Œä¸º
                    if (!e.target.closest('button')) {
                        e.preventDefault();
                    }
                    
                    // éå†æ‰€æœ‰è§¦æ‘¸ç‚¹
                    for (let i = 0; i < e.touches.length; i++) {
                        const touch = e.touches[i];
                        // æ¯æ¬¡è§¦æ‘¸éƒ½æœ‰50%æ¦‚ç‡ç”Ÿæˆè›‹ç³•ï¼Œæ¯”é¼ æ ‡ç§»åŠ¨æ¦‚ç‡æ›´é«˜
                        if (Math.random() < 0.5) {
                            this.createCakeEmoji(touch.clientX, touch.clientY);
                        }
                    }
                }, { passive: false });
                
                // è§¦å±ç§»åŠ¨ç‰¹æ•ˆï¼ˆå¯é€‰ï¼‰
                document.addEventListener('touchmove', (e) => {
                    // éå†æ‰€æœ‰è§¦æ‘¸ç‚¹
                    for (let i = 0; i < e.touches.length; i++) {
                        const touch = e.touches[i];
                        // ç§»åŠ¨æ—¶è¾ƒä½æ¦‚ç‡ç”Ÿæˆè›‹ç³•
                        if (Math.random() < 0.15) {
                            this.createCakeEmoji(touch.clientX, touch.clientY);
                        }
                    }
                }, { passive: true });
            }
            
            createCakeEmoji(x, y) {
                const cake = document.createElement('div');
                cake.className = 'cake-emoji';
                cake.textContent = 'ğŸ‚';
                cake.style.left = x + 'px';
                cake.style.top = y + 'px';
                document.body.appendChild(cake);
                
                setTimeout(() => {
                    document.body.removeChild(cake);
                }, 2000);
            }
            
            async requestNotificationPermission() {
                if ('Notification' in window) {
                    const permission = await Notification.requestPermission();
                    this.hasNotificationPermission = permission === 'granted';
                }
            }
            
            showNotification(title, body) {
                if (this.hasNotificationPermission) {
                    new Notification(title, {
                        body: body,
                        icon: 'birthday.png'
                    });
                }
            }
            
            handlePrimaryAction() {
                switch (this.state) {
                    case 'before':
                        this.startPomodoro();
                        break;
                    case 'working':
                        this.earlyRest();
                        break;
                    case 'after':
                        // è¿™ä¸ªçŠ¶æ€ä¸‹ä¼šæœ‰ä¸¤ä¸ªæŒ‰é’®ï¼Œåœ¨updateDisplayä¸­å¤„ç†
                        break;
                    case 'resting':
                        this.endRest();
                        break;
                }
            }
            
            async startPomodoro() {
                await this.requestNotificationPermission();
                this.state = 'working';
                this.timeLeft = 25 * 60;
                this.totalDuration = 25 * 60;
                this.startTimer();
                this.updateDisplay();
            }
            
            earlyRest() {
                this.stopTimer();
                this.state = 'before';
                this.timeLeft = 25 * 60;
                this.updateDisplay();
            }
            
            startRest() {
                this.state = 'resting';
                this.timeLeft = this.restTime;
                this.totalDuration = this.restTime;
                this.startTimer();
                this.updateDisplay();
            }
            
            endRest() {
                this.stopTimer();
                this.state = 'before';
                this.timeLeft = 25 * 60;
                this.updateDisplay();
            }
            
            endPomodoro() {
                this.state = 'before';
                this.timeLeft = 25 * 60;
                this.updateDisplay();
            }
            
            startTimer() {
                this.startTime = Date.now(); // è®°å½•å¼€å§‹æ—¶é—´æˆ³
                this.timer = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                    this.timeLeft = Math.max(0, this.totalDuration - elapsed);
                    this.updateTimerDisplay();
                    
                    if (this.timeLeft <= 0) {
                        this.stopTimer();
                        this.onTimerComplete();
                    }
                }, 100); // æ›´é¢‘ç¹çš„æ£€æŸ¥ï¼Œæé«˜ç²¾åº¦
            }
            
            stopTimer() {
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                    this.startTime = null;
                }
            }
            
            onTimerComplete() {
                if (this.state === 'working') {
                    this.state = 'after';
                    this.showNotification('ç•ªèŒ„é’Ÿå®Œæˆï¼', 'æ­å–œä½ å®Œæˆäº†25åˆ†é’Ÿçš„ä¸“æ³¨æ—¶é—´ï¼');
                } else if (this.state === 'resting') {
                    this.state = 'before';
                    this.timeLeft = 25 * 60;
                    this.showNotification('ä¼‘æ¯ç»“æŸï¼', 'å‡†å¤‡å¼€å§‹ä¸‹ä¸€ä¸ªç•ªèŒ„é’Ÿå§ï¼');
                }
                this.updateDisplay();
            }
            
            updateDisplay() {
                this.updateStatusText();
                this.updateTimerDisplay();
                this.updateButtons();
                this.updateImageAnimation();
            }
            
            updateStatusText() {
                const texts = {
                    'before': 'å¼€å§‹ä»Šå¤©çš„ä¸“æ³¨å§',
                    'working': 'åŠªåŠ›å­¦ä¹ ä¸­...',
                    'after': 'å¤šå¤šçœŸæ£’ï¼Œåˆä¸“æ³¨äº†å‘¢~<br>åŠ æ²¹ï¼ä½ çš„æ¢¦æƒ³éƒ½ä¼šå®ç°çš„',
                    'resting': 'åŠ³é€¸ç»“åˆåœ°åŠªåŠ›ç€å‘¢'
                };
                this.statusText.innerHTML = texts[this.state];
            }
            
            updateTimerDisplay() {
                const minutes = Math.floor(this.timeLeft / 60);
                const seconds = this.timeLeft % 60;
                this.timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateButtons() {
                const buttonConfigs = {
                    'before': [{ text: 'å¼€å§‹ä¸“æ³¨', action: () => this.startPomodoro(), class: 'pixel-btn-pink' }],
                    'working': [{ text: 'æå‰ä¼‘æ¯', action: () => this.earlyRest(), class: 'pixel-btn-lavender' }],
                    'after': [
                        { text: 'å¼€å§‹ä¼‘æ¯', action: () => this.startRest(), class: 'pixel-btn-rose' },
                        { text: 'ç»“æŸä¸“æ³¨', action: () => this.endPomodoro(), class: 'pixel-btn-purple' }
                    ],
                    'resting': [{ text: 'ç»“æŸä¼‘æ¯', action: () => this.endRest(), class: 'pixel-btn-peach' }]
                };
                
                const config = buttonConfigs[this.state];
                this.buttonArea.innerHTML = '';
                
                config.forEach(btn => {
                    const button = document.createElement('button');
                    button.className = `pixel-btn ${btn.class} pixel-font px-6 py-3 rounded-lg text-lg font-bold`;
                    button.textContent = btn.text;
                    button.addEventListener('click', btn.action);
                    this.buttonArea.appendChild(button);
                });
            }
            
            updateImageAnimation() {
                if (this.state === 'working') {
                    this.mainImage.classList.add('pulse-animation');
                } else {
                    this.mainImage.classList.remove('pulse-animation');
                }
            }
        }
        
        // åˆå§‹åŒ–ç•ªèŒ„é’Ÿ
        document.addEventListener('DOMContentLoaded', () => {
            new PomodoroTimer();
        });
    </script>
</body>
</html>