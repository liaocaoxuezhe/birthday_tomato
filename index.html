<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎂</title>
    
    <!-- 网站缩略图/预览图设置 -->
    <meta property="og:title" content="🎂 生日快乐">
    <meta property="og:description" content="生日祝福网站">
    <meta property="og:image" content="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='50' font-size='50' text-anchor='middle' x='50'%3e🎂%3c/text%3e%3c/svg%3e">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="🎂 生日快乐">
    <meta name="twitter:description" content="生日祝福网站">
    <meta name="twitter:image" content="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='50' font-size='50' text-anchor='middle' x='50'%3e🎂%3c/text%3e%3c/svg%3e">
    
    <!-- Favicon设置 -->
    <link rel="icon" href="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='50' font-size='50' text-anchor='middle' x='50'%3e🎂%3c/text%3e%3c/svg%3e">
    
    <link href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/TakWolf/fusion-pixel-font@main/dist/fusion-pixel-8px-monospaced-zh_hans.css" rel="stylesheet">
    <style>
        * {
            font-family: 'Press Start 2P', 'Courier New', 'Monaco', 'Menlo', 'Consolas', monospace;
        }
        
        /* 像素风格字体 */
        .pixel-font {
            font-family: 'Press Start 2P', 'Courier New', monospace;
            image-rendering: pixelated;
            -webkit-font-smoothing: none;
            font-smoothing: none;
            letter-spacing: 1px;
        }
        
        /* 像素风格按钮基础样式 */
        .pixel-btn {
            border: 3px solid #8b5a8c;
            box-shadow: 3px 3px 0px #d4a5d6;
            transition: all 0.1s ease;
            image-rendering: pixelated;
            position: relative;
        }
        
        /* 像素风格纹理覆盖层 */
        .pixel-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%), 
                        linear-gradient(-45deg, rgba(255,255,255,0.15) 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.15) 75%), 
                        linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.15) 75%);
            background-size: 4px 4px;
            background-position: 0 0, 0 2px, 2px -2px, -2px 0px;
            pointer-events: none;
        }
        
        .pixel-btn:hover {
            transform: translate(1px, 1px);
            box-shadow: 2px 2px 0px #d4a5d6;
        }
        
        .pixel-btn:active {
            transform: translate(3px, 3px);
            box-shadow: 0px 0px 0px #d4a5d6;
        }
        
        /* 精致女神配色按钮样式 */
        .pixel-btn-pink {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            color: #8b5a8c;
            font-weight: bold;
        }
        
        .pixel-btn-pink:hover {
            background: linear-gradient(135deg, #ff8a95 0%, #fdbde8 50%, #fdbde8 100%);
        }
        
        .pixel-btn-lavender {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 50%, #d299c2 100%);
            color: #6b4c93;
            font-weight: bold;
        }
        
        .pixel-btn-lavender:hover {
            background: linear-gradient(135deg, #96e6e2 0%, #fcc5d8 50%, #c788b3 100%);
        }
        
        .pixel-btn-rose {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 50%, #ff8a80 100%);
            color: #8b4513;
            font-weight: bold;
        }
        
        .pixel-btn-rose:hover {
            background: linear-gradient(135deg, #ffe0c4 0%, #faa690 50%, #ff7a70 100%);
        }
        
        .pixel-btn-purple {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: white;
            font-weight: bold;
        }
        
        .pixel-btn-purple:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 50%, #e083eb 100%);
        }
        
        .pixel-btn-peach {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 50%, #fd79a8 100%);
            color: #8b4513;
            font-weight: bold;
        }
        
        .pixel-btn-peach:hover {
            background: linear-gradient(135deg, #fde498 0%, #f9a190 50%, #fc6998 100%);
        }
        
        /* 像素风格图片 */
        .pixel-img {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        /* 精致女神风格倒计时显示 */
        .timer-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: 4px solid #8b5a8c;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            box-shadow: 
                inset 0 0 20px rgba(255, 255, 255, 0.3),
                0 0 20px rgba(139, 90, 140, 0.4);
            border-radius: 15px;
        }
        
        /* 生日蛋糕emoji动效 */
        .cake-emoji {
            position: fixed;
            font-size: 24px;
            pointer-events: none;
            z-index: 1000;
            animation: float 2s ease-out forwards;
        }
        
        @keyframes float {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) rotate(360deg);
            }
        }
        
        /* 脉冲动画 */
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 10px rgba(255, 154, 158, 0.6));
            }
            50% {
                transform: scale(1.05);
                filter: drop-shadow(0 0 20px rgba(255, 154, 158, 0.8));
            }
        }
        
        /* 页面背景渐变 */
        body {
            background: linear-gradient(135deg, #ffeef8 0%, #f8f4ff 50%, #fff0f5 100%);
            min-height: 100vh;
        }
        
        /* 状态文字样式 */
 zd        .status-text {
            color: #2d1b69;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }
        background: linear-gradient(135deg, #ff9a9e, #fecfef, #a8edea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .pixel-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .timer-display {
                font-size: 20px;
                padding: 12px;
            }
            
            /* 移动端图片优化 */
            .pixel-img {
                max-height: 280px;
                width: auto;
                object-fit: contain;
            }
            
            /* 调整容器间距 */
            .container {
                padding: 12px;
                max-width: 100%;
            }
            
            .mb-8 {
                margin-bottom: 1rem;
            }
            
            .mb-6 {
                margin-bottom: 0.75rem;
            }
            
            .status-text {
                font-size: 16px;
                line-height: 1.4;
            }
        }
        
        @media (max-width: 480px) {
            .pixel-btn {
                padding: 8px 16px;
                font-size: 12px;
                min-height: 44px; /* 确保触摸友好 */
            }
            
            .timer-display {
                font-size: 18px;
                padding: 10px;
            }
            
            /* 小屏幕图片优化 */
            .pixel-img {
                max-height: 240px;
                width: auto;
            }
            
            .status-text {
                font-size: 14px;
                line-height: 1.3;
            }
            
            /* 确保页面内容在视窗内 */
            body {
                padding: 8px;
            }
            
            .container {
                padding: 8px;
                max-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            
            .mb-8 {
                margin-bottom: 0.75rem;
            }
            
            .mb-6 {
                margin-bottom: 0.5rem;
            }
            
            /* 按钮区域优化 */
            #buttonArea {
                gap: 8px;
            }
        }
        
        /* iPhone SE 等小屏设备特殊适配 */
        @media (max-width: 375px) and (max-height: 667px) {
            .pixel-img {
                max-height: 200px;
            }
            
            .timer-display {
                font-size: 16px;
                padding: 8px;
            }
            
            .status-text {
                font-size: 12px;
            }
            
            .container {
                padding: 6px;
            }
            
            .mb-8 {
                margin-bottom: 0.5rem;
            }
            
            .mb-6 {
                margin-bottom: 0.25rem;
            }
        }
        
        /* iPhone Pro Max 等大屏适配 */
        @media (max-width: 428px) and (min-height: 900px) {
            .pixel-img {
                max-height: 320px;
            }
            
            .timer-display {
                font-size: 22px;
                padding: 14px;
            }
            
            .status-text {
                font-size: 18px;
            }
        }
        
        /* 横屏适配 */
        @media (max-height: 500px) and (orientation: landscape) {
            .pixel-img {
                max-height: 150px;
            }
            
            .container {
                padding: 4px;
            }
            
            .mb-8 {
                margin-bottom: 0.25rem;
            }
            
            .mb-6 {
                margin-bottom: 0.25rem;
            }
            
            .timer-display {
                font-size: 16px;
                padding: 6px;
            }
            
            .status-text {
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .pixel-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .timer-display {
                font-size: 20px;
                padding: 12px;
            }
            
            /* iPhone Pro 优化 - 显著增大 */
            .pixel-img {
                max-height: 380px;
                width: auto;
            }
            
            .status-text {
                font-size: 18px;
                line-height: 1.3;
            }
            
            /* 确保页面内容在视窗内 */
            body {
                padding: 6px;
            }
            
            .container {
                max-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
            
            .mb-8 {
                margin-bottom: 0.75rem;
            }
            
            .mb-6 {
                margin-bottom: 0.5rem;
            }
        }
        
        /* iPhone Pro Max 特殊适配 */
        @media (max-width: 428px) and (max-height: 926px) {
            .pixel-img {
                max-height: 400px;
            }
            
            .timer-display {
                font-size: 18px;
                padding: 10px;
            }
            
            .status-text {
                font-size: 16px;
            }
        }
        
        /* iPhone Pro 标准版适配 */
        @media (max-width: 390px) and (max-height: 844px) {
            .pixel-img {
                max-height: 360px;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="container max-w-md mx-auto text-center">
        <!-- 主图片 -->
        <div class="mb-8">
            <img src="birthday.png" alt="Birthday" class="pixel-img mx-auto max-w-full h-auto rounded-lg pulse-animation" id="mainImage">
        </div>
        
        <!-- 状态文字 -->
        <div class="mb-6">
            <p class="pixel-font status-text text-xl md:text-2xl leading-relaxed" id="statusText">
                开始今天的专注吧
            </p>
        </div>
        
        <!-- 倒计时显示 -->
        <div class="mb-8">
            <div class="timer-display inline-block px-6 py-4 text-2xl md:text-3xl" id="timerDisplay">
                25:00
            </div>
        </div>
        
        <!-- 按钮区域 -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center" id="buttonArea">
            <button class="pixel-btn pixel-btn-pink pixel-font px-6 py-3 rounded-lg text-lg font-bold" id="primaryBtn">
                开始专注
            </button>
        </div>
    </div>
    
    <script>
        class PomodoroTimer {
            constructor() {
                this.state = 'before'; // before, working, after, resting
                this.timeLeft = 25 * 60; // 25分钟
                this.restTime = 5 * 60; // 5分钟
                this.timer = null;
                this.hasNotificationPermission = false;
                this.startTime = null; // 添加开始时间戳
                this.totalDuration = 0; // 添加总时长
                
                this.statusText = document.getElementById('statusText');
                this.timerDisplay = document.getElementById('timerDisplay');
                this.buttonArea = document.getElementById('buttonArea');
                this.primaryBtn = document.getElementById('primaryBtn');
                this.mainImage = document.getElementById('mainImage');
                
                this.init();
            }
            
            init() {
                this.updateDisplay();
                this.setupEventListeners();
                this.setupMouseEffect();
            }
            
            setupEventListeners() {
                this.primaryBtn.addEventListener('click', () => this.handlePrimaryAction());
            }
            
            setupMouseEffect() {
                // 鼠标移动特效
                document.addEventListener('mousemove', (e) => {
                    if (Math.random() < 0.1) { // 10%概率生成蛋糕
                        this.createCakeEmoji(e.clientX, e.clientY);
                    }
                });
                
                // 触屏点击特效
                document.addEventListener('touchstart', (e) => {
                    // 只在非按钮元素上阻止默认行为
                    if (!e.target.closest('button')) {
                        e.preventDefault();
                    }
                    
                    // 遍历所有触摸点
                    for (let i = 0; i < e.touches.length; i++) {
                        const touch = e.touches[i];
                        // 每次触摸都有50%概率生成蛋糕，比鼠标移动概率更高
                        if (Math.random() < 0.5) {
                            this.createCakeEmoji(touch.clientX, touch.clientY);
                        }
                    }
                }, { passive: false });
                
                // 触屏移动特效（可选）
                document.addEventListener('touchmove', (e) => {
                    // 遍历所有触摸点
                    for (let i = 0; i < e.touches.length; i++) {
                        const touch = e.touches[i];
                        // 移动时较低概率生成蛋糕
                        if (Math.random() < 0.15) {
                            this.createCakeEmoji(touch.clientX, touch.clientY);
                        }
                    }
                }, { passive: true });
            }
            
            createCakeEmoji(x, y) {
                const cake = document.createElement('div');
                cake.className = 'cake-emoji';
                cake.textContent = '🎂';
                cake.style.left = x + 'px';
                cake.style.top = y + 'px';
                document.body.appendChild(cake);
                
                setTimeout(() => {
                    document.body.removeChild(cake);
                }, 2000);
            }
            
            async requestNotificationPermission() {
                if ('Notification' in window) {
                    const permission = await Notification.requestPermission();
                    this.hasNotificationPermission = permission === 'granted';
                }
            }
            
            showNotification(title, body) {
                if (this.hasNotificationPermission) {
                    new Notification(title, {
                        body: body,
                        icon: 'birthday.png'
                    });
                }
            }
            
            handlePrimaryAction() {
                switch (this.state) {
                    case 'before':
                        this.startPomodoro();
                        break;
                    case 'working':
                        this.earlyRest();
                        break;
                    case 'after':
                        // 这个状态下会有两个按钮，在updateDisplay中处理
                        break;
                    case 'resting':
                        this.endRest();
                        break;
                }
            }
            
            async startPomodoro() {
                await this.requestNotificationPermission();
                this.state = 'working';
                this.timeLeft = 25 * 60;
                this.totalDuration = 25 * 60;
                this.startTimer();
                this.updateDisplay();
            }
            
            earlyRest() {
                this.stopTimer();
                this.state = 'before';
                this.timeLeft = 25 * 60;
                this.updateDisplay();
            }
            
            startRest() {
                this.state = 'resting';
                this.timeLeft = this.restTime;
                this.totalDuration = this.restTime;
                this.startTimer();
                this.updateDisplay();
            }
            
            endRest() {
                this.stopTimer();
                this.state = 'before';
                this.timeLeft = 25 * 60;
                this.updateDisplay();
            }
            
            endPomodoro() {
                this.state = 'before';
                this.timeLeft = 25 * 60;
                this.updateDisplay();
            }
            
            startTimer() {
                this.startTime = Date.now(); // 记录开始时间戳
                this.timer = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                    this.timeLeft = Math.max(0, this.totalDuration - elapsed);
                    this.updateTimerDisplay();
                    
                    if (this.timeLeft <= 0) {
                        this.stopTimer();
                        this.onTimerComplete();
                    }
                }, 100); // 更频繁的检查，提高精度
            }
            
            stopTimer() {
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                    this.startTime = null;
                }
            }
            
            onTimerComplete() {
                if (this.state === 'working') {
                    this.state = 'after';
                    this.showNotification('番茄钟完成！', '恭喜你完成了25分钟的专注时间！');
                } else if (this.state === 'resting') {
                    this.state = 'before';
                    this.timeLeft = 25 * 60;
                    this.showNotification('休息结束！', '准备开始下一个番茄钟吧！');
                }
                this.updateDisplay();
            }
            
            updateDisplay() {
                this.updateStatusText();
                this.updateTimerDisplay();
                this.updateButtons();
                this.updateImageAnimation();
            }
            
            updateStatusText() {
                const texts = {
                    'before': '开始今天的专注吧',
                    'working': '努力学习中...',
                    'after': '多多真棒，又专注了呢~<br>加油！你的梦想都会实现的',
                    'resting': '劳逸结合地努力着呢'
                };
                this.statusText.innerHTML = texts[this.state];
            }
            
            updateTimerDisplay() {
                const minutes = Math.floor(this.timeLeft / 60);
                const seconds = this.timeLeft % 60;
                this.timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateButtons() {
                const buttonConfigs = {
                    'before': [{ text: '开始专注', action: () => this.startPomodoro(), class: 'pixel-btn-pink' }],
                    'working': [{ text: '提前休息', action: () => this.earlyRest(), class: 'pixel-btn-lavender' }],
                    'after': [
                        { text: '开始休息', action: () => this.startRest(), class: 'pixel-btn-rose' },
                        { text: '结束专注', action: () => this.endPomodoro(), class: 'pixel-btn-purple' }
                    ],
                    'resting': [{ text: '结束休息', action: () => this.endRest(), class: 'pixel-btn-peach' }]
                };
                
                const config = buttonConfigs[this.state];
                this.buttonArea.innerHTML = '';
                
                config.forEach(btn => {
                    const button = document.createElement('button');
                    button.className = `pixel-btn ${btn.class} pixel-font px-6 py-3 rounded-lg text-lg font-bold`;
                    button.textContent = btn.text;
                    button.addEventListener('click', btn.action);
                    this.buttonArea.appendChild(button);
                });
            }
            
            updateImageAnimation() {
                if (this.state === 'working') {
                    this.mainImage.classList.add('pulse-animation');
                } else {
                    this.mainImage.classList.remove('pulse-animation');
                }
            }
        }
        
        // 初始化番茄钟
        document.addEventListener('DOMContentLoaded', () => {
            new PomodoroTimer();
        });
    </script>
</body>
</html>